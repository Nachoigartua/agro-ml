CREATE EXTENSION IF NOT EXISTS postgis;
CREATE EXTENSION IF NOT EXISTS "uuid-ossp";
CREATE TABLE IF NOT EXISTS predicciones (id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),fecha_creacion TIMESTAMP DEFAULT NOW(),tipo VARCHAR(50) NOT NULL,lote_id VARCHAR(50),cultivo VARCHAR(50),fecha_validez_desde DATE,fecha_validez_hasta DATE,recomendacion_principal JSONB,alternativas JSONB,nivel_confianza FLOAT,datos_entrada JSONB,modelo_version VARCHAR(20));
CREATE TABLE IF NOT EXISTS clima_historico (id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),latitud FLOAT,longitud FLOAT,fecha DATE,temperatura_max FLOAT,temperatura_min FLOAT,precipitacion FLOAT,humedad_relativa FLOAT,radiacion_solar FLOAT,velocidad_viento FLOAT);
CREATE TABLE IF NOT EXISTS caracteristicas_suelo (id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),lote_id VARCHAR(50),profundidad_cm INTEGER,ph FLOAT,materia_organica FLOAT,nitrogeno FLOAT,fosforo FLOAT,potasio FLOAT,textura VARCHAR(40));
CREATE TABLE IF NOT EXISTS lotes (id VARCHAR(50) PRIMARY KEY,nombre VARCHAR(120),area_ha FLOAT,cultivo VARCHAR(50),latitud FLOAT,longitud FLOAT);
INSERT INTO lotes (id,nombre,area_ha,cultivo,latitud,longitud) VALUES ('L001','Lote Norte',45,'trigo',-34.6,-58.44);
INSERT INTO lotes (id,nombre,area_ha,cultivo,latitud,longitud) VALUES ('L002','Lote Sur',62,'soja',-33.15,-60.35);
INSERT INTO lotes (id,nombre,area_ha,cultivo,latitud,longitud) VALUES ('L003','Campo Alto',38,'maiz',-36.62,-64.29);
INSERT INTO lotes (id,nombre,area_ha,cultivo,latitud,longitud) VALUES ('L004','La Esperanza',55,'cebada',-32.95,-60.66);
INSERT INTO clima_historico (latitud,longitud,fecha,temperatura_max,temperatura_min,precipitacion,humedad_relativa,radiacion_solar,velocidad_viento) VALUES (-34.60,-58.44,'2025-08-19',23.6,10.6,2.0,55.0,4.0,8.0);
INSERT INTO clima_historico (latitud,longitud,fecha,temperatura_max,temperatura_min,precipitacion,humedad_relativa,radiacion_solar,velocidad_viento) VALUES (-34.60,-58.44,'2025-08-18',24.6,11.6,5.0,56.0,4.5,10.0);
INSERT INTO clima_historico (latitud,longitud,fecha,temperatura_max,temperatura_min,precipitacion,humedad_relativa,radiacion_solar,velocidad_viento) VALUES (-34.60,-58.44,'2025-08-17',25.6,12.6,8.0,57.0,5.0,12.0);
INSERT INTO clima_historico (latitud,longitud,fecha,temperatura_max,temperatura_min,precipitacion,humedad_relativa,radiacion_solar,velocidad_viento) VALUES (-34.60,-58.44,'2025-08-16',26.6,10.6,11.0,58.0,5.5,14.0);
INSERT INTO clima_historico (latitud,longitud,fecha,temperatura_max,temperatura_min,precipitacion,humedad_relativa,radiacion_solar,velocidad_viento) VALUES (-34.60,-58.44,'2025-08-15',23.6,11.6,14.0,59.0,6.0,8.0);
INSERT INTO clima_historico (latitud,longitud,fecha,temperatura_max,temperatura_min,precipitacion,humedad_relativa,radiacion_solar,velocidad_viento) VALUES (-34.60,-58.44,'2025-08-14',24.6,12.6,2.0,60.0,6.5,10.0);
INSERT INTO clima_historico (latitud,longitud,fecha,temperatura_max,temperatura_min,precipitacion,humedad_relativa,radiacion_solar,velocidad_viento) VALUES (-34.60,-58.44,'2025-08-13',25.6,10.6,5.0,61.0,4.0,12.0);
INSERT INTO caracteristicas_suelo (lote_id,profundidad_cm,ph,materia_organica,nitrogeno,fosforo,potasio,textura) VALUES ('L001',20,6.4,2.6,0.22,15.0,180.0,'franco');
INSERT INTO clima_historico (latitud,longitud,fecha,temperatura_max,temperatura_min,precipitacion,humedad_relativa,radiacion_solar,velocidad_viento) VALUES (-33.15,-60.35,'2025-08-19',23.6,10.1,2.0,55.0,4.0,8.0);
INSERT INTO clima_historico (latitud,longitud,fecha,temperatura_max,temperatura_min,precipitacion,humedad_relativa,radiacion_solar,velocidad_viento) VALUES (-33.15,-60.35,'2025-08-18',24.6,11.1,5.0,56.0,4.5,10.0);
INSERT INTO clima_historico (latitud,longitud,fecha,temperatura_max,temperatura_min,precipitacion,humedad_relativa,radiacion_solar,velocidad_viento) VALUES (-33.15,-60.35,'2025-08-17',25.6,12.1,8.0,57.0,5.0,12.0);
INSERT INTO clima_historico (latitud,longitud,fecha,temperatura_max,temperatura_min,precipitacion,humedad_relativa,radiacion_solar,velocidad_viento) VALUES (-33.15,-60.35,'2025-08-16',26.6,10.1,11.0,58.0,5.5,14.0);
INSERT INTO clima_historico (latitud,longitud,fecha,temperatura_max,temperatura_min,precipitacion,humedad_relativa,radiacion_solar,velocidad_viento) VALUES (-33.15,-60.35,'2025-08-15',23.6,11.1,14.0,59.0,6.0,8.0);
INSERT INTO clima_historico (latitud,longitud,fecha,temperatura_max,temperatura_min,precipitacion,humedad_relativa,radiacion_solar,velocidad_viento) VALUES (-33.15,-60.35,'2025-08-14',24.6,12.1,2.0,60.0,6.5,10.0);
INSERT INTO clima_historico (latitud,longitud,fecha,temperatura_max,temperatura_min,precipitacion,humedad_relativa,radiacion_solar,velocidad_viento) VALUES (-33.15,-60.35,'2025-08-13',25.6,10.1,5.0,61.0,4.0,12.0);
INSERT INTO caracteristicas_suelo (lote_id,profundidad_cm,ph,materia_organica,nitrogeno,fosforo,potasio,textura) VALUES ('L002',20,6.4,2.6,0.22,15.0,180.0,'franco');
INSERT INTO clima_historico (latitud,longitud,fecha,temperatura_max,temperatura_min,precipitacion,humedad_relativa,radiacion_solar,velocidad_viento) VALUES (-36.62,-64.29,'2025-08-19',23.7,10.6,2.0,55.0,4.0,8.0);
INSERT INTO clima_historico (latitud,longitud,fecha,temperatura_max,temperatura_min,precipitacion,humedad_relativa,radiacion_solar,velocidad_viento) VALUES (-36.62,-64.29,'2025-08-18',24.7,11.6,5.0,56.0,4.5,10.0);
INSERT INTO clima_historico (latitud,longitud,fecha,temperatura_max,temperatura_min,precipitacion,humedad_relativa,radiacion_solar,velocidad_viento) VALUES (-36.62,-64.29,'2025-08-17',25.7,12.6,8.0,57.0,5.0,12.0);
INSERT INTO clima_historico (latitud,longitud,fecha,temperatura_max,temperatura_min,precipitacion,humedad_relativa,radiacion_solar,velocidad_viento) VALUES (-36.62,-64.29,'2025-08-16',26.7,10.6,11.0,58.0,5.5,14.0);
INSERT INTO clima_historico (latitud,longitud,fecha,temperatura_max,temperatura_min,precipitacion,humedad_relativa,radiacion_solar,velocidad_viento) VALUES (-36.62,-64.29,'2025-08-15',23.7,11.6,14.0,59.0,6.0,8.0);
INSERT INTO clima_historico (latitud,longitud,fecha,temperatura_max,temperatura_min,precipitacion,humedad_relativa,radiacion_solar,velocidad_viento) VALUES (-36.62,-64.29,'2025-08-14',24.7,12.6,2.0,60.0,6.5,10.0);
INSERT INTO clima_historico (latitud,longitud,fecha,temperatura_max,temperatura_min,precipitacion,humedad_relativa,radiacion_solar,velocidad_viento) VALUES (-36.62,-64.29,'2025-08-13',25.7,10.6,5.0,61.0,4.0,12.0);
INSERT INTO caracteristicas_suelo (lote_id,profundidad_cm,ph,materia_organica,nitrogeno,fosforo,potasio,textura) VALUES ('L003',20,6.4,2.6,0.22,15.0,180.0,'franco');
INSERT INTO clima_historico (latitud,longitud,fecha,temperatura_max,temperatura_min,precipitacion,humedad_relativa,radiacion_solar,velocidad_viento) VALUES (-32.95,-60.66,'2025-08-19',23.3,11.0,2.0,55.0,4.0,8.0);
INSERT INTO clima_historico (latitud,longitud,fecha,temperatura_max,temperatura_min,precipitacion,humedad_relativa,radiacion_solar,velocidad_viento) VALUES (-32.95,-60.66,'2025-08-18',24.3,12.0,5.0,56.0,4.5,10.0);
INSERT INTO clima_historico (latitud,longitud,fecha,temperatura_max,temperatura_min,precipitacion,humedad_relativa,radiacion_solar,velocidad_viento) VALUES (-32.95,-60.66,'2025-08-17',25.3,13.0,8.0,57.0,5.0,12.0);
INSERT INTO clima_historico (latitud,longitud,fecha,temperatura_max,temperatura_min,precipitacion,humedad_relativa,radiacion_solar,velocidad_viento) VALUES (-32.95,-60.66,'2025-08-16',26.3,11.0,11.0,58.0,5.5,14.0);
INSERT INTO clima_historico (latitud,longitud,fecha,temperatura_max,temperatura_min,precipitacion,humedad_relativa,radiacion_solar,velocidad_viento) VALUES (-32.95,-60.66,'2025-08-15',23.3,12.0,14.0,59.0,6.0,8.0);
INSERT INTO clima_historico (latitud,longitud,fecha,temperatura_max,temperatura_min,precipitacion,humedad_relativa,radiacion_solar,velocidad_viento) VALUES (-32.95,-60.66,'2025-08-14',24.3,13.0,2.0,60.0,6.5,10.0);
INSERT INTO clima_historico (latitud,longitud,fecha,temperatura_max,temperatura_min,precipitacion,humedad_relativa,radiacion_solar,velocidad_viento) VALUES (-32.95,-60.66,'2025-08-13',25.3,11.0,5.0,61.0,4.0,12.0);
INSERT INTO caracteristicas_suelo (lote_id,profundidad_cm,ph,materia_organica,nitrogeno,fosforo,potasio,textura) VALUES ('L004',20,6.4,2.6,0.22,15.0,180.0,'franco');